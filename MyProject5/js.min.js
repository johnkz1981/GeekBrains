"use strict";if(!localStorage.getItem("cart")){let t=[];localStorage.setItem("cart",JSON.stringify(t))}let productsInCart=JSON.parse(localStorage.getItem("cart"));const cart={totalCartSettings:{totalQty:0,totalPrice:0},createTotalCartSettings(){for(let t=0;t<productsInCart.length;t++)this.totalCartSettings.totalQty+=productsInCart[t].qty,this.totalCartSettings.totalPrice+=productsInCart[t].price*productsInCart[t].qty},init(){const t=document.querySelectorAll(".add-cart");this.createTotalCartSettings(),this.outputQtyTotalPrice(),this.createListContainer(),this.addProductToCart(t)},outputQtyTotalPrice(){this.totalCartSettings.totalQty>0?document.querySelector(".totalQty").classList.add("active"):document.querySelector(".totalQty").classList.remove("active"),document.querySelector(".totalQty").innerHTML=this.totalCartSettings.totalQty,document.querySelector(".totalPrice_price").innerHTML=this.totalCartSettings.totalPrice},addProductToCart(t){for(let a=0;a<t.length;a++)t[a].addEventListener("click",t=>this.addToCart(t),!0)},addToCart(t){this.checkForAvailability(t),this.createListContainer(),this.changeTotalCounter(t)},checkForAvailability(t){let a=null;for(let s of t.composedPath())"add-cart"===s.className&&(a=+s.dataset.id);for(let t=0;t<productsInCart.length;t++)if(productsInCart[t].id===a)return productsInCart[t].qty+=1,void localStorage.setItem("cart",JSON.stringify(productsInCart));this.addNewProduct(t)},addNewProduct(t){for(let a of t.composedPath())"add-cart"===a.className&&productsInCart.push({id:+a.dataset.id,name:a.dataset.name,price:+a.dataset.price,img:a.dataset.img,qty:1});localStorage.setItem("cart",JSON.stringify(productsInCart))},changeTotalCounter(t){this.totalCartSettings.totalQty+=1;for(let a of t.composedPath())"add-cart"===a.className&&(this.totalCartSettings.totalPrice+=+a.dataset.price);this.outputQtyTotalPrice()},createListContainer(){const t=document.querySelector(".productsInCart");t.innerHTML='\n          <div class="item">\n            <a href="single-page.html">\n              <img src="img/Layer_44.jpg" alt="">\n            </a>\n            <div>\n              <div class="caption">Rebox Zane</div>\n              <div class="star">\n                <i class="fas fa-star"></i>\n                <i class="fas fa-star"></i>\n                <i class="fas fa-star"></i>\n                <i class="fas fa-star"></i>\n                <i class="fas fa-star-half-alt"></i>\n              </div>\n              <div class="price">1 x\n                <span>$250</span>\n              </div>\n            </div>\n            <div class="close">\n              <i class="fas fa-times-circle"></i>\n            </div>\n\n          </div>\n          <div class="hr"></div>\n          \n          <div class="h4">';for(let a=0;a<productsInCart.length;a++){const s=document.createElement("article");s.classList.add("item"),t.appendChild(s);const r=document.createElement("a");r.setAttribute("href","single.html?id="+productsInCart[a].id),r.classList.add("productCartCard_image"),s.appendChild(r);const e=new Image;e.src=`img/${productsInCart[a].img}`,e.alt=productsInCart[a].name,r.appendChild(e);const c=document.createElement("div");c.classList.add("productCartInfo"),s.appendChild(c);const i=document.createElement("div");i.classList.add("caption"),i.innerHTML=productsInCart[a].name,c.appendChild(i);const d=document.createElement("div");d.classList.add("star"),c.appendChild(d);const o=4.5;for(let t=0;t<Math.round(o);t++){const a=document.createElement("i");a.classList.add("fas"),t===Math.round(o)-1&&o!==Math.round(o)?a.classList.add("fa-star-half-alt"):a.classList.add("fa-star"),d.appendChild(a)}const n=document.createElement("div");n.classList.add("productCartPrice"),n.classList.add("price"),n.innerHTML=`${productsInCart[a].qty} x \n                                      <span class="productCartPrice"> $${productsInCart[a].price} </span>`,c.appendChild(n);const l=document.createElement("div");l.classList.add("close"),s.appendChild(l);const p=document.createElement("i");p.classList.add("productCartButton"),p.innerHTML='<i class ="fas fa-times-circle"></i>',p.setAttribute("data-id",productsInCart[a].id),p.addEventListener("click",t=>{t.stopPropagation(),this.deleteFromCart(t)}),l.appendChild(p);const u=document.createElement("div");u.classList.add("hr"),t.appendChild(u);const h=document.createElement("h4");u.classList.add("h4"),t.appendChild(h)}},deleteFromCart(t){let a=null;for(let s of t.composedPath())"productCartButton"===s.className&&(a=+s.dataset.id);for(let t=0;t<productsInCart.length;t++)productsInCart[t].id===a&&(this.totalCartSettings.totalQty-=productsInCart[t].qty,this.totalCartSettings.totalPrice-=productsInCart[t].price*productsInCart[t].qty,productsInCart.splice(t,1));this.createListContainer(),this.outputQtyTotalPrice(),localStorage.setItem("cart",JSON.stringify(productsInCart))}},pageCart={init(){this.createCart()},createCart(){const t=$(".cart__table");t.html("");for(let a=0;a<productsInCart.length;a++){let s=$("<tr/>");s.appendTo(t),$("<th/>",{class:"text-center"}).html(a+1).appendTo(s);let r=$("<td/>",{class:"text-center"});$("<img>",{src:"img/"+productsInCart[a].img,alt:productsInCart[a].title,style:"width: 50px"}).appendTo(r),r.appendTo(s);let e=$("<td/>",{class:"text-center"});$("<a/>",{href:"products.html?id="+productsInCart[a].id}).html(productsInCart[a].name).appendTo(e),e.appendTo(s),$("<td/>",{class:"text-center"}).html(productsInCart[a].qty).appendTo(s),$("<td/>",{class:"text-center"}).html(productsInCart[a].price+" руб.").appendTo(s),$("<td/>",{class:"text-center"}).html(productsInCart[a].qty*productsInCart[a].price+" руб.").appendTo(s);let c=$("<button/>",{class:"productCartButton","data-id":productsInCart[a].id});c.click(t=>{this.refreshCart(t)}),c.html("Del").appendTo(s)}},refreshCart(t){cart.deleteFromCart(t),this.createCart()}};fetch("json/productsData.json").then(t=>(console.log(t),t.json())).then(t=>{console.log(t)}).catch(t=>console.log(t)),cart.init(),$(document).ready(function(){const t=document.querySelector(".cart");t.addEventListener("click",a=>{a.preventDefault(),t.classList.toggle("active")});const a=$(".product-wrapper"),s=1;let r=new ProductCart(s,"Продукт 1","Layer2.jpg",1e3,2.5,"product","image-product","text-product","product__rating","product__price","product__price_btn add_to_cart","products.html?id="+s);a.append(r.render())});class Products{constructor(t,a,s,r,e){this.productId=t,this.productName=a,this.productImg=s,this.productPrice=r,this.productRating=e}}class ProductCart extends Products{constructor(t,a,s,r,e,c,i,d,o,n,l,p){super(t,a,s,r,e),this.productCartClass=c,this.productImgClass=i,this.productNameClass=d,this.productRatingClass=o,this.productPriceClass=n,this.productBtnClass=l,this.productLink=p}render(){const t=`<div class="product ">\n    <div class="image-product ">\n      <a href="single-page.html">\n        <img src="img/${this.productImg}" alt=" ${this.productName} ">\n      </a>\n      <div class="add-cart"\n           data-name="${this.productName}"\n           data-price="${this.productPrice}"\n           data-id="${this.productId}"\n           data-img="${this.productImg}>\n        <img src="img/basket2.svg " alt="Cart ">\n        <span>Add to Cart</span>\n      </div>\n    </div>\n    <a href="single-page.html">\n      <div class="text-product ">\n        <p>${this.productName}</p>\n        <p>\n          <span>${this.productPrice}</span>\n        </p>\n      </div>\n    </a>\n  </div>`;let a='<div class="'+this.productCartClass+'">';a+='<a href="'+this.productLink+'" class="'+this.productImgClass+'" data-id="'+this.productId+'">',a+='<img src="img/'+this.productImg+'" alt="'+this.productName+'">',a+="</a>",a+='<div class="'+this.productNameClass+'">',a+='<a href="'+this.productLink+'" data-id="'+this.productId+'">',a+=this.productName,a+="</a>",a+="</div>",a+='<div class="'+this.productRatingClass+'">';for(let t=0;t<Math.round(this.productRating);t++)a+='<i class="fas fa-star"></i>';for(let t=0;t<5-Math.round(this.productRating);t++)a+='<i class="far fa-star"></i>';return a+="</div>",a+='<div class="'+this.productPriceClass+'">',a+='<button class="'+this.productBtnClass+'" data-id="'+this.productId+'" data-name="'+this.productName+'" data-img="'+this.productImg+'" data-price="'+this.productPrice+'">',a+=this.productPrice+" руб.",a+="</button>",a+="</div>",t}}class SingleProduct extends Products{constructor(t,a,s,r,e,c,i,d,o,n,l,p,u){super(t,a,s,r,e),this.productImgClass=c,this.productNameClass=i,this.productRatingClass=d,this.productPriceClass=o,this.productBtnClass=n,this.productDescription1=l,this.productDescription2=p,this.productDescription3=u}render(){let t='<div class="col-md-4 col-sm-12 product__info__left">';t+='<div class="'+this.productImgClass+'">',t+='<img src="img/'+this.productImg+'" alt="'+this.productName+'">',t+="</div>",t+='<button class="'+this.productBtnClass+'" data-id="'+this.productId+'" data-name="'+this.productName+'" data-img="'+this.productImg+'" data-price="'+this.productPrice+'">',t+="Купить",t+="</button>",t+="</div>",t+='<div class="col-md-7 col-md-offset-1 col-sm-12 product__info__right">',t+='<h3 class="'+this.productNameClass+'">',t+=this.productName,t+="</h3>",t+='<p class="'+this.productPriceClass+'">',t+="Цена: "+this.productPrice+" руб.",t+="</p>",t+='<div class="'+this.productRatingClass+'">';for(let a=0;a<Math.round(this.productRating);a++)t+='<i class="fas fa-star"></i>';for(let a=0;a<5-Math.round(this.productRating);a++)t+='<i class="far fa-star"></i>';return t+="</div>",t+=this.renderTab(),t+="</div>"}renderTab(){let t='<div class="tab">';return t+='<ul class="tab__item">',t+='<li class="active">1</li>',t+="<li>2</li>",t+="<li>3</li>",t+="</ul>",t+='<div class="desc1 tab__description active">'+this.productDescription1+"</div>",t+='<div class="desc2 tab__description">'+this.productDescription2+"</div>",t+='<div class="desc3 tab__description">'+this.productDescription3+"</div>",t+="</div>"}}class RecommendationProduct extends Products{constructor(t,a,s){super(t,a,s)}render(){let t='<a href="products.html?id='+this.productId+'">';return t+='<img src="img/'+this.productImg+'" alt="'+this.productName+'">',t+="</a>"}}